---
title: "Opdracht_Uitvoering"
author: "Micha Snippe, Niek Scholten, Jelle Becirspahic"
date: "15-5-2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r import_onderzoek_data, include=FALSE}
# Data set inlezen
library(readr)
Onderzoek_Antwoorden <- read_csv("Social media (Antwoorden) - Formulierreacties 1.csv")
```

##Data verzamelen
Om de data te verkrijgen die we nodig hadden hebben we een Google form enquête gebruikt die we zelf in elkaar hadden gezet. Deze enquête bevat vragen over hoe mensen sociale media gebruiken en wat ze er van vinden, ook bevat het vragen om een beeld te scheppen hoe sociaal ze zijn IRL.

##Missende data
Aangezien sommige antwoorden, vragen uitsluiten aangezien ze niet van toepassing zijn bevind er in onze dataset missende data. Deze missende data gaan we waarschijnlijk negeren aangezien deze niet van toepassing waren voor de persoon die de enquête had ingevuld.

##Start uitwerking deelvragen
###Hoeveel wordt sociale media gebruikt?  
Om de gegevens weet te geven voor deze vraag gebruiken we een staaf diagram met de vijf grote sociale media platformen plus een sectie met de overige platformen waar de hoogte weergeeft hoeveel tijd er gemiddeld voor het sociale platform wordt gebruikt.  
```{r data_setup_deelvraag_1, include = FALSE}

# Verzamel de data van tijd besteed op elke platvorm
levels_insta <- c("0 to 1 hour(s)", "1 to 2 hours", "3 to 4 hours", "4 to 5 hours", "5 to 6 hours", ">6 hours")
time_insta <- factor(Onderzoek_Antwoorden$`How much time do you spend on this platform daily?`, levels = levels_insta)

levels_fb <- c("0 to 1 hour(s)", "1 to 2 hours", "3 to 4 hours", "4 to 5 hours", "5 to 6 hours", ">6 hours")
time_fb <- factor(Onderzoek_Antwoorden$`How much time do you spend on this platform daily?_1`, levels = levels_fb)

levels_whatsapp <- c("0 - 30 minutes", "30 minutes - 1 hour", "1 - 1.5 hours", "1.5 - 2 hours", "2 - 2.5 hours", ">3 hours")
time_whatsapp <- factor(Onderzoek_Antwoorden$`How much time do you spend on this platform daily?_2`, levels = levels_whatsapp)

levels_twitter <- c("0 to 1 hour(s)", "1 to 2 hours", "3 to 4 hours", "4 to 5 hours", "5 to 6 hours", ">6 hours")
time_twitter <- factor(Onderzoek_Antwoorden$`How much time do you spend on this platform daily?_3`, levels = levels_twitter)

levels_snap <- c("0 to 1 hour(s)", "1 to 2 hours", "3 to 4 hours", "4 to 5 hours", "5 to 6 hours", ">6 hours")
time_snap <- factor(Onderzoek_Antwoorden$`How much time do you spend on this platform daily?_4`, levels = levels_snap)

levels_disc <- c("< 1 hour", "1 - 2 hours", "2 - 3 hours", "3 - 4 hours", "5 - 6 hours", "> 6 hours")
time_disc <- factor(Onderzoek_Antwoorden$`How much time, on average, do you spend on these platforms daily?`, levels = levels_disc)

levels_overig <- c("0 - 30 minutes", "30 minutes - 1 hour", "1 - 1.5 hours", "1.5 - 2 hours", "2 - 3 hours", "3 - 4 hours", "4 - 5 hours", ">5 hours")
time_overig <- factor(Onderzoek_Antwoorden$`How much time, on average, do you spend on these social platforms on a daily basis?`, levels = levels_overig)

time_list <- list(Instagram = time_insta, Facebook = time_fb, Whatsapp = time_whatsapp, Twitter = time_twitter, Snapchat = time_snap, Discord = time_disc, Overige_Platforms = time_overig, All_platforms = time_all)

# Verwijder de level variabelen
rm(levels_insta, levels_fb, levels_whatsapp, levels_twitter, levels_snap, levels_disc, levels_overig)

# Verwijder de losse variabelen
rm(time_insta, time_fb, time_whatsapp, time_twitter, time_snap, time_disc, )
```

**Instagram**  
```{r graph_insta_platvorm, echo=FALSE}
barplot(table(time_insta),
        main = "The time people spend on instagram on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_insta)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie []"
        )
```

**Facebook**  
```{r graph_facebook_platvorm, echo=FALSE}
barplot(table(time_fb),
        main = "The time people spend on facebook on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_fb)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie"
        )
```

**Whatsapp**  
```{r graph_whatsapp_platvorm, echo=FALSE}
barplot(table(time_whatsapp),
        main = "The time people spend on Whatsapp on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_whatsapp)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie"
        )
```

**Twitter**  
```{r graph_twitter_platvorm, echo=FALSE}
barplot(table(time_twitter),
        main = "The time people spend on Twitter on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_twitter)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie"
        )
```

**Snapchat**  
```{r graph_snapchat_platvorm, echo=FALSE}
barplot(table(time_snap),
        main = "The time people spend on Snapchat on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_snap)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie"
        )
```

**Discord, Teamspeak en Skype**  
```{r graph_disk_team_skype_platvormen, echo=FALSE}
barplot(table(time_disc),
        main = "The time people spend on Discord, Teamspeak and Skype on a daily basis",
        col = rainbow(6),
        cex.names = .8, 
        ylim = c(0, max(table(time_disc)) + 5),
        xlab = "Time Spend using the social platform",
        ylab = "Frequentie"
        )
```
**Overige Platvormen**  
```{r graph_overige_platvormen, echo=FALSE}
barplot(table(time_overig),
        main = "The time people spend on the other platforms on a daily basis",
        col = rainbow(8),
        cex.names = .5, 
        ylim = c(0, max(table(time_overig)) + 5),
        xlab = "Time Spend using the social platforms",
        ylab = "Frequentie"
        )
```

**Gemiddelde per platvorm en gemiddelde totaal van elk platform**  
```{r numeric_data_setup, echo=FALSE}
time_insta.numeric <- c(0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6)[time_insta]
time_fb.numeric <- c(0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6)[time_fb]
time_whatsapp.numeric <- c(0.25, 0.75, 1.25, 1.75, 2.25, 3)[time_whatsapp]
time_twitter.numeric <- c(0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6)[time_twitter]
time_snap.numeric <- c(0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6)[time_snap]
time_disc.numeric <- c(0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6)[time_disc]
time_overig.numeric <- c(0.25, 0.75, 1.25, 1.75, 2.5, 3.5, 4.5, 5)[time_overig]
time_all.numeric <- c(time_insta.numeric, time_fb.numeric, time_whatsapp.numeric, time_twitter.numeric, time_snap.numeric, time_disc.numeric, time_overig.numeric)

time_list.numeric <- list(Instagram = time_insta.numeric, Facebook = time_fb.numeric, Whatsapp = time_whatsapp.numeric, Twitter = time_twitter.numeric, Snapchat = time_snap.numeric, Discord = time_disc.numeric, Overige_Platforms = time_overig.numeric, All_platforms = time_all.numeric)

rm(time_insta.numeric, time_fb.numeric, time_whatsapp.numeric, time_twitter.numeric, time_snap.numeric, time_disc.numeric, time_overig.numeric, time_all.numeric)

```

```{r calculating_mean, echo=FALSE}
# Bereken het gemiddelde voor elke platvorm
time_insta.mean <- mean(time_list.numeric$Instagram, na.rm = TRUE)
time_fb.mean <- mean(time_list.numeric$Facebook, na.rm = TRUE)
time_whatsapp.mean <- mean(time_list.numeric$Whatsapp, na.rm = TRUE)
time_twitter.mean <- mean(time_list.numeric$Twitter, na.rm = TRUE)
time_snap.mean <- mean(time_list.numeric$Snapchat, na.rm = TRUE)
time_disc.mean <- mean(time_list.numeric$Discord, na.rm = TRUE)
time_overig.mean <- mean(time_list.numeric$Overige_Platforms, na.rm = TRUE)
time_all.mean <- mean(c(time_insta.mean, time_fb.mean, time_whatsapp.mean, time_twitter.mean, time_snap.mean, time_disc.mean, time_overig.mean), na.rm = TRUE)

# Zet de berekende gemiddelde in een lijst
time_list.mean <- list(Instagram = time_insta.mean, Facebook = time_fb.mean, Whatsapp = time_whatsapp.mean, Twitter = time_twitter.mean, Snapchat = time_snap.mean, Discord = time_disc.mean, Overige_Platforms = time_overig.mean, All_platforms = time_all.mean)

# verwijder de losse variabelen
rm(time_insta.mean, time_fb.mean, time_whatsapp.mean, time_twitter.mean, time_snap.mean, time_disc.mean, time_overig.mean, time_all.mean)
```

```{r graph_mean_time_spend, echo=FALSE}
barplot(as.numeric(time_list.mean),
        main = "The time people spend averagely on each platform on a daily basis",
        col = rainbow(8),
        cex.names = .5,
        ylim = c(0, max(table(gem_tijd_platvormen)) + 1),
        names.arg = names(time_list.mean),
        xlab = "Average time spend on each platvorm",
        ylab = "Time"
        )
```

```{r print_mean_time, echo=FALSE}
# Log de means
cat("De gemiddelde tijd besteed in instagram:", time_list.mean$Instagram, "uur\n")
cat("De gemiddelde tijd besteed in facebook:", time_list.mean$Facebook, "uur\n")
cat("De gemiddelde tijd besteed in whatsapp:", time_list.mean$Whatsapp, "uur\n")
cat("De gemiddelde tijd besteed in twitter:", time_list.mean$Twitter, "uur\n")
cat("De gemiddelde tijd besteed in snapchat:", time_list.mean$Snapchat, "uur\n")
cat("De gemiddelde tijd besteed in discord, teamspeak en skype:", time_list.mean$Discord, "uur\n")
cat("De gemiddelde tijd besteed aan de overige platvormen:", time_list.mean$Overige_Platforms, "uur\n")
cat("De gemiddelde tijd besteed aan alle platvormen:", time_list.mean$All_platforms, "uur\n")
```

###Wat is het verschil in sociale media gebruik tussen de leeftijden?  
Om hier antwoord op te geven gebruiken we een staaf diagram die weergeeft hoeveel tijd er gestoken wordt in sociale media voor elke leeftijd van <16 tot >30 in stappen van 1.  

```{r plot_sociale_media_per_leeftijd}
# Verzamel alle leeftijden 
age <- as.numeric(Onderzoek_Antwoorden$`What is your age?`)

# Een vector die alle leeftijden bevat die gemeten zijn van min tot max
age_range <- min(age, na.rm = T):max(age, na.rm = T)

# Loop door elk platform heen
for (platform in names(time_list.numeric)){
  
  # Lege vector voor de gemiddelden van het platform
  average_time_per_age <- numeric(0)
  
  # Loop door alle leeftijden
  for(num in age_range){
    # Bereken het gemiddelde tijd besteed op het platform
    gem <- mean(time_list.numeric[[platform]][age == num], na.rm = T)
    
    # Zet het gemiddelde in de container vector
    average_time_per_age <- c(average_time_per_age, gem)
    
    # Log het gemiddelde
    #cat("The average time spent by", num, "year olds on this platform is", gem, "uur\n")
    rm(num, gem)
  }
  
  # Plot de gemiddelde tijd besteed voor elke leeftijd
  plot(age_range, average_time_per_age, type = "h", 
       lwd = 15,
       main = paste("Average time spent on ", platform, " per age"),
       xlab = "Age [years]",
       ylab = "Time spent on the platform [hours]",
       col = rainbow(max(age, na.rm = T) - min(age, na.rm = T) + 1)
       )
  
  rm(platform, average_time_per_age)
}

rm(age, age_range)
```

Hoeveel wordt elk sociaal platvorm gebruikt
```{r Deelvraag_3_data}
use_instagram <- Onderzoek_Antwoorden$`Do you use Instagram?`
use_facebook <- Onderzoek_Antwoorden$`Do you use Facebook?`
use_whatsapp <- Onderzoek_Antwoorden$`Do you use Whatsapp?`
use_twitter <- Onderzoek_Antwoorden$`Do you use Twitter?`
use_snapchat <- Onderzoek_Antwoorden$`Do you use Snapchat?`
use_discord <- Onderzoek_Antwoorden$`Do you use any of these platforms?`
use_overig.ruw <- Onderzoek_Antwoorden$`What other social media platforms do you use?`
use_overig <- strsplit(use_overig.ruw, ",")

use_instagram.logical <- c(TRUE, FALSE)[factor(use_instagram, levels = c("Yes", "No"))]
use_facebook.logical <- c(TRUE, FALSE)[factor(use_facebook, levels = c("Yes", "No"))]
use_whatsapp.logical <- c(TRUE, FALSE)[factor(use_whatsapp, levels = c("Yes", "No"))]
use_twitter.logical <- c(TRUE, FALSE)[factor(use_twitter, levels = c("Yes", "No"))]
use_snapchat.logical <- c(TRUE, FALSE)[factor(use_snapchat, levels = c("Yes", "No"))]
use_discord.logical <- c(TRUE, FALSE)[factor(use_discord, levels = c("Yes", "No"))]

unique(unlist(use_overig))
# unique
```

```{r}
par(mfrow = c(2, 2))
barplot(table(use_instagram.logical))
barplot(table(use_facebook))
barplot(table(use_whatsapp))
barplot(table(use_twitter))

par(mfrow = c(1, 1))
pie(table(use_snapchat))
pie(table(use_discord))
```

```{r remove_variables_except_research_data, include=FALSE}
#rm(list=c(ls()[ls() != "Onderzoek_Antwoorden"]))
```